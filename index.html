<!--
In this game you need to move the basket right of left across the screen
using left and right arrow buttons trying to catch as many fruit
as you can. The fruit are continuously falling from above. Different types of fruit give you
different score. The order is this (from highest to lowest scoring:)
melon -> pineapple -> orange -> apple -> banana. The score also depends on the speed
the fruit is falling at. The faster it is falling, the more score you get.
The game keeps tracks of your total score, the number of fruit you missed, and how many you caught.
Upon missing 10 pieces of fruit, the game is over. You can restart the game by pressing ENTER
on the game over screen. The game also shows the hi score which updates at the game over screen
if you succeeded to beat it.

The game also uses music and a couple of sound effects.
-->
<!DOCTYPE html>
<html>
    <head>
        <title>Retard Game</title>
        <link rel="icon" href="Images/logo-transparent.png">
        <meta charset="UTF-8">
        <link rel="stylesheet" href="styles.css">
        <style type="text/css">
           
        </style>
        
        <script type="text/javascript">
        
            window.onload = function()
            {
                var canvas = document.getElementById("canvas");
                var context = canvas.getContext("2d");
                var canvasBack = document.getElementById("backgroundCanvas");
                var contextBack = canvasBack.getContext("2d");
                
                // 添加调整 canvas 分辨率的函数
                function resizeCanvas() {
                    const container = document.querySelector('.game-container');
                    const containerWidth = container.offsetWidth;
                    const containerHeight = container.offsetHeight;
                    
                    canvas.width = containerWidth;
                    canvas.height = containerHeight;
                    canvasBack.width = containerWidth;
                    canvasBack.height = containerHeight;
                    
                    // 重新设置字体，因为 canvas 重置会清除字体设置
                    contextBack.font = "bold 80px Arial"; // 增大字体尺寸
                    contextBack.fillStyle = "WHITE";
                }
                
                // 页面加载和窗口调整时重设 canvas 尺寸
                window.addEventListener('resize', resizeCanvas);
                resizeCanvas();
                
                //Timer for the Timeout - needed in order to clear it
                var timer;
                
                //Keeps track of hi score
                var hiscore = 0;
                
                //Background image, music track, and arrays of sounds.
                //Arrays are needed so that the same sounds
                //can overlap with each other
                var background = new Image();
                background.src = 'Images/background.png';
                
                var player;
                var fruits = [];
                var numberOfFruits = 15;
                
                var gameStarted = false;
                var startScreen = document.getElementById("startScreen");
                
                // 添加响应式调整函数
                function getResponsiveSize() {
                    if (window.innerWidth <= 768) {
                        return {
                            playerWidth: 100,  // 手机端人物宽度
                            playerHeight: 200,  // 1:2比例
                            fruitSize: 50,    // 减小手机端掉落物品大小
                            fontSize: 16,      // 减小手机端文字大小
                            gameOverFontSize: 32, // 游戏结束文字大小
                            headerFontSize: 12,    // 更小的顶部文字
                        };
                    } else if (window.innerWidth <= 1024) {
                        return {
                            playerWidth: 150,
                            playerHeight: 300,
                            fruitSize: 80,    // 减小平板端掉落物品大小
                            fontSize: 24,
                            gameOverFontSize: 40,
                            headerFontSize: 16,
                        };
                    } else {
                        return {
                            playerWidth: 320,
                            playerHeight: 640,
                            fruitSize: 180,
                            fontSize: 40,
                            gameOverFontSize: 80,
                            headerFontSize: 40
                        };
                    }
                }
                
                //Player constructor
                function Player()
                {
                    const sizes = getResponsiveSize();
                    this.gameOver = false;
                    this.score = 0;
                    this.fruitsCollected = 0;
                    this.fruitsMissed = 0;
                    this.playerWidth = sizes.playerWidth;
                    this.playerHeight = sizes.playerHeight;
                    this.playerSpeed = 15;
                    this.x = canvas.width / 2;
                    this.y = canvas.height - this.playerHeight;
                    this.playerImage = new Image();
                    this.playerImage.src = 'Images/figure.png';
                    
                    //Draws the player
                    this.render = function()
                    {
                        context.drawImage(this.playerImage, this.x, this.y, this.playerWidth, this.playerHeight);
                    }
                    
                    //Moves the player left
                    this.moveLeft = function()
                    {
                        if(this.x > 0)
                        {
                            this.x -= this.playerSpeed;
                        }
                    }
                    
                    //Moves the player right
                    this.moveRight = function()
                    {
                        if(this.x < canvas.width - this.playerWidth)
                        {
                            this.x += this.playerSpeed;
                        }
                    }
                }
                
                //Fruit constructor
                function Fruit()
                {
                    const sizes = getResponsiveSize();
                    this.fruitNumber = Math.floor(Math.random() * 4);
                    this.fruitType = "";
                    this.fruitScore = 0;
                    this.fruitWidth = sizes.fruitSize;
                    this.fruitHeight = sizes.fruitSize;
                    this.fruitImage = new Image();
                    this.fruitSpeed = Math.floor(Math.random() * 3 + 1) * 0.8;
                    this.x = Math.random() * (canvas.width - this.fruitWidth);
                    this.y = Math.random() * -canvas.height - this.fruitHeight;
                    
                    this.chooseFruit = function()
                    {
                        if(this.fruitNumber == 0)
                        {
                            this.fruitType = "banana";
                            this.fruitScore = Math.round(5 * this.fruitSpeed);
                            this.fruitImage.src = 'Images//coin-1.png';
                        }
                        else if(this.fruitNumber == 1)
                        {
                            this.fruitType = "apple";
                            this.fruitScore = Math.round(10 * this.fruitSpeed);
                            this.fruitImage.src = 'Images//coin-2.png';
                        }
                        else if(this.fruitNumber == 2)
                        {
                            this.fruitType = "orange";
                            this.fruitScore = Math.round(15 * this.fruitSpeed);
                            this.fruitImage.src = 'Images/coin-3.png';
                        }
                        else if(this.fruitNumber == 3)
                        {
                            this.fruitType = "pineapple";
                            this.fruitScore = Math.round(20 * this.fruitSpeed);
                            this.fruitImage.src = 'Images//coin-4.png';
                        }
                    }
                    
                    //Makes the fruit descend.
                    //While falling checks if the fruit has been caught by the player
                    //Or if it hit the floor.
                    this.fall = function()
                    {
                        if(this.y < canvas.height - this.fruitHeight)
                        {
                            this.y += this.fruitSpeed;
                        }
                        else
                        {
                            player.fruitsMissed += 1;
                            this.changeState();
                            this.chooseFruit();
                        }
                        this.checkIfCaught();
                    }
                    
                    //Checks if the fruit has been caught by the player
                    //If it is caught, the player score and fruit counter is increased, and
                    //the current fruit changes its state and becomes a different fruit.
                    this.checkIfCaught = function()
                    {
                        if(this.y >= player.y)
                        {
                            if((this.x > player.x && this.x < (player.x + player.playerWidth)) ||
                              (this.x + this.fruitWidth > player.x && this.x + this.fruitWidth < (player.x + player.playerWidth)))
                            {
                                player.score += this.fruitScore;
                                player.fruitsCollected += 1;
                                
                                this.changeState();
                                this.chooseFruit();
                            }
                        }
                    }
                    
                    //Randomly updates the fruit speed, fruit number, which defines the type of fruit
                    //And also changes its x and y position on the canvas.
                    this.changeState = function()
                    {
                        this.fruitNumber = Math.floor(Math.random() * 4);
                        this.fruitSpeed = Math.floor(Math.random() * 3 + 1) * 0.8;
                        this.x = Math.random() * (canvas.width - this.fruitWidth);
                        this.y = Math.random() * -canvas.height - this.fruitHeight;
                    }
                    
                    //Draws the fruit.
                    this.render = function()
                    {
                        context.drawImage(this.fruitImage, this.x, this.y, this.fruitWidth, this.fruitHeight);
                    }
                }
                
                //Adds controls. Left arrow to move left, right arrow to move right.
                //ENTER to restart only works at the game over screen.
                window.addEventListener("keydown", function(e)
                {
                    e.preventDefault();
                    if(e.keyCode == 13) {
                        if(!gameStarted) {
                            gameStarted = true;
                            startScreen.style.display = "none";
                            main();
                        } else if(player.gameOver) {
                            main();
                            window.clearTimeout(timer);
                        }
                    }
                    if(gameStarted) {
                        if(e.keyCode == 37)
                        {
                            player.moveLeft();
                        }
                        else if(e.keyCode == 39)
                        {
                            player.moveRight();
                        }
                    }
                });
                
                main();

                //Fills an array of fruits, creates a player and starts the game
                function main()
                {
                    contextBack.font = "bold 23px Arial";
                    contextBack.fillStyle = "WHITE";
                    player = new Player();
                    fruits = [];

                    for(var i = 0; i < numberOfFruits; i++)
                    {
                        var fruit = new Fruit();
                        fruit.chooseFruit();
                        fruits.push(fruit);
                    }
                    
                    startGame();
                }
                
                function startGame()
                {
                    updateGame();
                    window.requestAnimationFrame(drawGame);
                }

                //Checks for gameOver and makes each fruit in the array fall down.
                function updateGame()
                {
                    if(player.fruitsMissed >= 10)
                    {
                        player.gameOver = true;
                    }
                    
                    for(var j = 0; j < fruits.length; j++)
                    {
                        fruits[j].fall();
                    }
                    timer = window.setTimeout(updateGame, 30);
                }
                
                //Draws the player and fruits on the screen as well as info in the HUD.
                function drawGame()
                {
                    const sizes = getResponsiveSize();
                    if(player.gameOver == false)
                    {
                        context.clearRect(0, 0, canvas.width, canvas.height);
                        contextBack.clearRect(0, 0, canvasBack.width, canvasBack.height);

                        contextBack.drawImage(background, 0, 0, canvasBack.width, canvasBack.height);
                        
                        player.render();

                        for(var j = 0; j < fruits.length; j++)
                        {
                            fruits[j].render();
                        }
                        
                        // 修改字体大小和位置
                        contextBack.font = `bold ${sizes.headerFontSize}px Arial`;
                        // 调整文字位置，使用更小的间距
                        if (window.innerWidth <= 768) {
                            contextBack.fillText("SCORE: " + player.score, canvasBack.width * 0.05, 30);
                            contextBack.fillText("HI: " + hiscore, canvasBack.width * 0.30, 30);
                            contextBack.fillText("CAUGHT: " + player.fruitsCollected, canvasBack.width * 0.50, 30);
                            contextBack.fillText("MISSED: " + player.fruitsMissed, canvasBack.width * 0.75, 30);
                        } else if (window.innerWidth <= 1024) {
                            contextBack.fillText("SCORE: " + player.score, canvasBack.width * 0.05, 40);
                            contextBack.fillText("HI: " + hiscore, canvasBack.width * 0.30, 40);
                            contextBack.fillText("CAUGHT: " + player.fruitsCollected, canvasBack.width * 0.50, 40);
                            contextBack.fillText("MISSED: " + player.fruitsMissed, canvasBack.width * 0.75, 40);
                        } else {
                            contextBack.fillText("SCORE: " + player.score, canvasBack.width * 0.05, 60);
                            contextBack.fillText("HI SCORE: " + hiscore, canvasBack.width * 0.25, 60);
                            contextBack.fillText("HAMBURGERS CAUGHT: " + player.fruitsCollected, canvasBack.width * 0.48, 60);
                            contextBack.fillText("HAMBURGERS MISSED: " + player.fruitsMissed, canvasBack.width * 0.78, 60);
                        }
                    }
                    else
                    {
                        // Different screen for game over
                        for(var i = 0; i < numberOfFruits; i++)
                        {
                            console.log("Speed was" + fruits[fruits.length - 1].fruitSpeed);
                            fruits.pop();
                        }
                        
                        // 添加半透明黑色背景
                        contextBack.fillStyle = "rgba(0, 0, 0, 0.7)";
                        contextBack.fillRect(0, 0, canvas.width, canvas.height);
                        
                        // 设置文字颜色为白色
                        contextBack.fillStyle = "WHITE";
                        
                        // 增大游戏结束时的字体
                        contextBack.font = `bold ${sizes.gameOverFontSize}px Arial`;
                        contextBack.textAlign = "center";
                        contextBack.textBaseline = "middle";
                        
                        if(hiscore < player.score)
                        {
                            hiscore = player.score;
                            contextBack.fillText("NEW HI SCORE: " + hiscore, canvas.width / 2, canvas.height / 2 - 40);
                        }
                        contextBack.fillText("PRESS ENTER TO RESTART", canvas.width / 2, canvas.height / 2 + 40);
                        context.clearRect(0, 0, canvas.width, canvas.height);
                    }
                    window.requestAnimationFrame(drawGame);
                    
                }
            }
        
        </script>
    </head>
    <body>
        <header class="main-header">
            <div class="logo">RETARD GAME</div>
            <div class="header-icons">
                <div class="icon">
                    <a href="https://t.me/Retard_Game" target="_blank"><img src="Images/icon-1.png" alt="social icon 1"></a>
                </div>
                <div class="icon">
                    <a href="https://x.com/Retard_Game_" target="_blank"><img src="Images/icon-2.png" alt="social icon 2"></a>
                </div>
                <div class="icon">
                    <a href="https://www.dextools.io/app/cn/solana/pair-explorer/443HohvHiBLB7kJbUnR9r7xnP3v3wLWRitXCpeLqZpVg?t=1747369406765" target="_blank"><img src="Images/icon-3.png" alt="social icon 3"></a>
                </div>
                <div class="icon">
                    <a href="https://dexscreener.com/solana/443HohvHiBLB7kJbUnR9r7xnP3v3wLWRitXCpeLqZpVg" target="_blank"><img src="Images/icon-4.png" alt="social icon 4"></a>
                </div>
            </div>
        </header>

        
        <div class="image-row">
            <div class="square-image">
                <img src="Images/image-1.png" alt="image 1">
            </div>
            <div class="square-image">
                <img src="Images/image-2.png" alt="image 2">
            </div>
            <div class="square-image">
                <img src="Images/image-3.png" alt="image 3">
            </div>
        </div>
        <div class="image-row">
            <div class="square-image">
                <img src="Images/image-4.png" alt="image 1">
            </div>
            <div class="square-image">
                <img src="Images/image-5.png" alt="image 2">
            </div>
            <div class="square-image">
                <img src="Images/image-6.png" alt="image 3">
            </div>
        </div>
        <div class="image-row">
            <div class="square-image">
                <img src="Images/image-7.png" alt="image 1">
            </div>
            <div class="square-image">
                <img src="Images/image-8.png" alt="image 2">
            </div>
            <div class="square-image">
                <img src="Images/image-9.png" alt="image 3">
            </div>
        </div>
        
        <div class="info-section">
            <p class="main-info">1,000,000,000 $ReGame on Solana free to trade</p>
            <p class="sub-info">join us on Telegram: <a href="https://t.me/Retard_Game" target="_blank">https://t.me/Retard_Game</a></p>
            <p class="sub-info">join us on X: <a href="https://x.com/Retard_Game_" target="_blank">https://x.com/Retard_Game_</a></p>
            <p class="small-info">$ReGame made by 4chan retard dev</p>
        </div>

        <div class="image-row">
            <div class="square-image">
                <img src="Images/image-10.png" alt="image 1">
            </div>
            <div class="square-image">
                <img src="Images/image-11.png" alt="image 2">
            </div>
        </div>
        <div class="image-row">
            <div class="square-image">
                <img src="Images/image-12.png" alt="image 1">
            </div>
            <div class="square-image">
                <img src="Images/image-13.png" alt="image 2">
            </div>
        </div>
        

        <div class="game-container">
            <div class="start-screen" id="startScreen">
                <img src="Images/logo-transparent.png" alt="game logo">
                <p>PRESS ENTER TO START</p>
            </div>
            <canvas id="backgroundCanvas" width="1024" height="650"></canvas>
            <canvas id="canvas" width="1024" height="650"></canvas>
        </div>
    </body>
</html>
